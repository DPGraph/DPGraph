<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Modern Business - Start Bootstrap Template</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/modern-business.css" rel="stylesheet">

  <!-- Vega -->
  <script src="https://vega.github.io/vega/vega.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@3"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@5"></script>

  <!-- Plotly-->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

</head>
<script>
  function hideoption(){
    document.getElementById("show_algorithm").style.visibility = "hidden";
    document.getElementById("select_algorithm_DD").style.visibility = "hidden";
    //document.getElementById("select_algorithm_DD_edge").style.visibility = "hidden";
    //document.getElementById("algorithm1").label = "testing";
    document.getElementById("algorithm1").checked = true;
    document.getElementById("algorithm1").style.visibility = "hidden";
    document.getElementById("algorithm2").style.visibility = "hidden";
    document.getElementById("algorithm3").style.visibility = "hidden";
    document.getElementById("algorithm4").style.visibility = "hidden";
    document.getElementById("algorithm5").style.visibility = "hidden";
    document.getElementById("algorithm6").style.visibility = "hidden";
    document.getElementById("algorithm2").checked = true;
    document.getElementById("algorithm3").checked = true;
    document.getElementById("algorithm4").checked = true;
    document.getElementById("algorithm5").checked = true;
    document.getElementById("algorithm6").checked = true;
  }
 
  function prepare(){
    hideoption();
  }
</script>
<body onload="frontierFn()">

  <!-- Navigation -->
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">DPGraph</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="problem.html">Problem Statement</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="frontier.html">Accuracy Frontier</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="performance.html">Performance Frontier</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownPortfolio" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Empirical Findings
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownPortfolio">
              <a class="dropdown-item" href="finding.html">Finding Overview</a>
              <a class="dropdown-item" href="#">Competitive Algorithm</a>
              <a class="dropdown-item" href="#">Effect of Data Shape</a>
              <a class="dropdown-item" href="#">Comparison Against Baseline</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBlog" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Background Overview
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownBlog">
              <a class="dropdown-item" href="glossary.html">Reference: Glossary</a>
              <a class="dropdown-item" href="dataset.html">Reference: Dataset</a>
              <a class="dropdown-item" href="algorithm.html">Reference: Algorithms</a>
              <a class="dropdown-item" href="DPdefinition.html">Reference: Differential Privacy</a>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>


  <!-- Page Content -->
  <div class="container">

    <h1 class="text-left">Privacy Performance Frontier</h1>

    <select id = "Degree Type" onchange = "DDFn()"> <!--onchange="frontierFn()"-->
      <option value = "1" selected = "selected">Node DP</option>
      <option value = "2">Edge DP</option>
      
      </select>

      <select id = "Utility" onchange = "DDFn()"> <!--onchange="frontierFn()"-->
      <option value = "1" selected = "selected">Degree Distribution</option>
      <option value = "2">Subgraph Counting_4kclique</option>
      <option value = "3">Subgraph Counting_3kstar</option>
      <option value = "4">Subgraph Counting_2ktriangle</option>
      <option value = "5">Subgraph Counting_0ktriangle</option>
      </select>
      

      <select id = "epsilon level" onchange = "DDFn()">
      <option value = "1" selected = "selected">0.01</option>
      <option value = "2" >0.02</option>
      <option value = "3" >0.05</option>
      <option value = "4" >0.1</option>
      <option value = "5" >0.2</option>
      <option value = "6" >0.5</option>
      <option value = "7" >1.0</option>
      <option value = "8" >2.0</option>
      <option value = "9" >5.0</option>
      <option value = "10">10.0</option>
    </select>
    <button id = "show_graph" onclick = "wrapper()">Apply Setting</button>
    <br>
    <script>
      var algoindex = [];
      var algorithms = [];
      var edgealgoindex =[];
      var edgealgorithms = [];
      var data = Object()
      var data ={};
      var x_value = ['FACEBOOK','WIKI','EMAIL','CIT','DBLP']
      function getcolor(name){
        if(name == 1)return '#e06377';
        else if(name ==2) return '#85E3FF';
        else if(name == 3) return '#b8a9c9';
        else if(name == 4) return '#c83349';
        else if(name == 5) return '#622569';
        else if(name == 6) return '#3fbf5b';
      }
      started = true
      function show_algorithm(){
        var dp_chosen = document.getElementById("Degree Type").value;
        var temp_query = document.getElementById("Utility").value;
        if(document.getElementById("select_algorithm_DD").style.visibility != "visible"){
          document.getElementById("select_algorithm_DD").style.visibility = "visible";
          document.getElementById("algorithm3").style.visibility = "visible";
          document.getElementById("algorithm4").style.visibility = "visible";
          document.getElementById("algorithm5").style.visibility = "visible";
          document.getElementById("algorithm6").style.visibility = "visible";
          document.getElementById("algorithm1").style.visibility = "visible";
          document.getElementById("algorithm2").style.visibility = "visible";
          if(dp_chosen == 1 && temp_query == 1) {
            document.getElementById("nodedp_algo1").style.display = "inline";
            document.getElementById("edgedp_algo1").style.display = "none";
            document.getElementById("sgcedgedp_algo1").style.display = "none";
            document.getElementById("nodedp_algo2").style.display = "inline";
            document.getElementById("edgedp_algo2").style.display = "none";
            document.getElementById("sgcedgedp_algo2").style.display = "none";
            document.getElementById("algorithm3").style.visibility = "visible";
            document.getElementById("nodedp_algo3").style.display = "inline";
            document.getElementById("sgcedgedp_algo3").style.display = "none";
            document.getElementById("algorithm4").style.visibility = "visible";
            document.getElementById("nodedp_algo4").style.display = "inline";
            document.getElementById("algorithm5").style.visibility = "visible";
            document.getElementById("nodedp_algo5").style.display = "inline";
            document.getElementById("algorithm6").style.visibility = "visible";
            document.getElementById("nodedp_algo6").style.display = "inline";
          } 
          else if(dp_chosen == 2 && temp_query == 1){
            document.getElementById("nodedp_algo1").style.display = "none";
            document.getElementById("edgedp_algo1").style.display = "inline";
            document.getElementById("sgcedgedp_algo1").style.display = "none";
            document.getElementById("nodedp_algo2").style.display = "none";
            document.getElementById("edgedp_algo2").style.display = "inline";
            document.getElementById("sgcedgedp_algo2").style.display = "none";
            document.getElementById("algorithm3").style.visibility = "hidden";
            document.getElementById("sgcedgedp_algo3").style.display = "none";
            document.getElementById("nodedp_algo3").style.display = "none";
            document.getElementById("algorithm4").style.visibility = "hidden";
            document.getElementById("nodedp_algo4").style.display = "none";
            document.getElementById("algorithm5").style.visibility = "hidden";
            document.getElementById("nodedp_algo5").style.display = "none";
            document.getElementById("algorithm6").style.visibility = "hidden";
            document.getElementById("nodedp_algo6").style.display = "none";
          }
          else if(dp_chosen == 2 && temp_query != 1){
            document.getElementById("nodedp_algo1").style.display = "none";
            document.getElementById("edgedp_algo1").style.display = "none";
            document.getElementById("sgcedgedp_algo1").style.display = "inline";
            document.getElementById("nodedp_algo2").style.display = "none";
            document.getElementById("edgedp_algo2").style.display = "none";
            document.getElementById("sgcedgedp_algo2").style.display = "inline";
            document.getElementById("sgcedgedp_algo3").style.display = "inline";
            document.getElementById("nodedp_algo3").style.display = "none";
            document.getElementById("algorithm4").style.visibility = "hidden";
            document.getElementById("nodedp_algo4").style.display = "none";
            document.getElementById("algorithm5").style.visibility = "hidden";
            document.getElementById("nodedp_algo5").style.display = "none";
            document.getElementById("algorithm6").style.visibility = "hidden";
            document.getElementById("nodedp_algo6").style.display = "none";
          }
        } else {
          document.getElementById("select_algorithm_DD").style.visibility = "hidden";
          document.getElementById("algorithm3").style.visibility = "hidden";
          document.getElementById("algorithm4").style.visibility = "hidden";
          document.getElementById("algorithm5").style.visibility = "hidden";
          document.getElementById("algorithm6").style.visibility = "hidden";
          document.getElementById("algorithm1").style.visibility = "hidden";
          document.getElementById("algorithm2").style.visibility = "hidden";    
        }
      }
      function changevisibility(i){
        var dp_chosen = document.getElementById("Degree Type").value;
        if(dp_chosen == 1){
          if(algoindex[i] == -1){
            algoindex[i] = i+1;
          }else{
            algoindex[i] = -1;
          }
        } else {
          if(edgealgoindex[i] == -1){
            edgealgoindex[i] = i+1;
          }
          else edgealgoindex[i] = -1;
        }
        //console.log(edgealgoindex)
        plot_graph()
        //plot_time(dataChosen);
      }
      function get_data(i,algoname,_callback){
        for(var k = 0; k < x_value.length; k++){
          data[x_value[k]] = []
        }
        var e_chosen = document.getElementById("epsilon level").value;
        if(e_chosen == 1) e_chosen = "0.01"
        else if(e_chosen == 2) e_chosen = "0.02"
        else if(e_chosen == 3) e_chosen = "0.05"
        else if(e_chosen == 4) e_chosen = "0.1"
        else if(e_chosen == 5) e_chosen = "0.2"
        else if(e_chosen == 6) e_chosen = "0.5"
        else if(e_chosen == 7) e_chosen = "1.0"
        else if(e_chosen == 8) e_chosen = "2.0"
        else if(e_chosen == 9) e_chosen = "5.0"
        else if(e_chosen == 10) e_chosen = "10.0"
        var dp_chosen = document.getElementById("Degree Type").value;
        var temp_query = document.getElementById("Utility").value;
        var y_value = []
        var csvName = "time"
        if(temp_query != 1) csvName = csvName+'SGC';
        if(dp_chosen == 2) lookingname = csvName + "edge";
        csvName = csvName+".csv"//We need the timeSGC.csv and timeSGCedge.csv
        Plotly.d3.csv(csvName,(error,rows)=>{
          for(var k = 0; k < x_value.length;k++){
            if(temp_query == 1){
              var d = rows.filter(r => r.algorithm == i && r.epsilon == e_chosen && r.data == x_value[k])
            } else{
              var d = rows.filter(r => r.algorithm == i && r.epsilon == e_chosen && r.data == x_value[k] && query == temp_query)
            }
            function unpack(rows, key) {
              return rows.map(function(row) { return row[key]; });
            }
            data[x_value[k]].push(unpack(d,'time')[0])
          }
        })
        _callback()
      }
      function DDFn(){
        var dp_chosen = document.getElementById("Degree Type").value;
        var temp_query = document.getElementById("Utility").value;
        var lookingname = "looking";
        if(temp_query != 1) lookingname = lookingname + "SGC";
        if(dp_chosen == 2) lookingname = lookingname + "edge";
        lookingname = lookingname + ".csv"
        Plotly.d3.csv(lookingname, (err, rows)=>{
          var l = rows.filter(r=>r.algo)
          algoindex = l.map(r => r.algo)
          edgealgoindex = l.map(r => r.algo);
          var k = rows.filter(r => r.algoname);
          algorithms = k.map(r=>r.algoname)
          edgealgorithms = k.map(r=>r.algoname)
          console.log(edgealgoindex)
          //Start data processing
          var e_chosen = document.getElementById("epsilon level").value;
          if(e_chosen == 1) e_chosen = "0.01"
          else if(e_chosen == 2) e_chosen = "0.02"
          else if(e_chosen == 3) e_chosen = "0.05"
          else if(e_chosen == 4) e_chosen = "0.1"
          else if(e_chosen == 5) e_chosen = "0.2"
          else if(e_chosen == 6) e_chosen = "0.5"
          else if(e_chosen == 7) e_chosen = "1.0"
          else if(e_chosen == 8) e_chosen = "2.0"
          else if(e_chosen == 9) e_chosen = "5.0"
          else if(e_chosen == 10) e_chosen = "10.0"
          var y_value = []
          if(dp_chosen == 1){
            for(var i = 1; i <= algoindex.length;i++){
              get_data(i,algorithms[i-1],function(){console.log(i+" done")})
            }
            console.log(data)
          } else {
            for(var i = 1; i <= edgealgoindex.length;i++){
              get_data(i,algorithms[i-1],function(){console.log(i+" done")})
            }
            console.log(data)
          }
        })
      }
      function frontierFn() {
        prepare();
        document.getElementById("show_algorithm").style.visibility = "visible";
        started = false
        DDFn()
        document.getElementById("scatterFrontier").style.visibility = "visible";
      }
      function wrapper(){
        plot_graph()
        show_algorithm()
      }
      function plot_graph(){
        new_data = []
        var k = 0;
        var dp_chosen = document.getElementById("Degree Type").value;
        if(dp_chosen == 1){
          while(k < algoindex.length){
            var y = []
            for(var i = 0; i < x_value.length;i++){
              if(algoindex[k] > 0){//This indicating that we are not having -1 for this value
                y.push(data[x_value[i]][k])
              }
            }
            var trace = {
              x:x_value,
              y:y,
              name:algorithms[k],
              type:'bar',
              marker:{
                color:getcolor(algorithms[k])
              }
            }
            new_data.push(trace)
            k++
          }
        } else {
          while(k < edgealgoindex.length){
            var y = []
            for(var i = 0; i < x_value.length;i++){
              if(edgealgoindex[k] > 0){//This indicating that we are not having -1 for this value
                y.push(data[x_value[i]][k])
              }
            }
            var trace = {
              x:x_value,
              y:y,
              name:algorithms[k],
              type:'bar',
              marker:{
                color:getcolor(k)
              }
            }
            new_data.push(trace)
            k++
          }
          //console.log(new_data)
        }
        //console.log(dp_chosen)
        var layout = {
            barmode: 'group',
            autosize: false,
            xaxis: {
              tickangle: -45,
              tickfont: {
                family: 'Old Standard TT, serif',
                size: 14,
                color: 'black'
              },
              titlefont: {
                family: 'Arial, sans-serif',
                size: 18,
                color: 'black'
              },
            },
            yaxis:{
              title: 'Time (s)',
              autorange: true,
              //range: getrange(dataChosen),
              tickangle: 45,
              titlefont: {
                family: 'Arial, sans-serif',
                size: 18,
                color: 'lightrgrey'
              },
              tickfont: {
                family: 'Old Standard TT, serif',
                size: 14,
                color: 'black'
              },
              range: [0,3],
              showexponent: 'all',              
            },
            title:'Time Taken ',
            showlegend: false
          };
          
        Plotly.d3.csv("looking.csv",(error,rows)=>{
          console.log(new_data)
          Plotly.newPlot("scatterFrontier",new_data,layout)
        })
      }

    </script>
<div id="DDContainer">
  <div style="float: left;" id="scatterFrontier"></div>
  
  <button id = "show_algorithm" onclick = "show_algorithm()">Settings</button><br>
  
  <form id = "select_algorithm_DD">
    <p>Please select the algorithm you want to display</p>
    <input type = "checkbox" onclick = "changevisibility(0)" id = "algorithm1">
    <span id="nodedp_algo1" style="display:inline; color:#e06377;">degHis_Lap.</span>
    <span id="sgcedgedp_algo1" style="display:inline; color:#e06377;">Ladder.</span>
    <span id="edgedp_algo1" style="display:none; color:#e06377;">degHis_Lap</span><br>
    <input type = "checkbox" onclick = "changevisibility(1)" id = "algorithm2">
    <span id="nodedp_algo2" style="display:inline; color:o#85E3FF;">degSeq_Lap</span>
    <span id="sgcedgedp_algo2" style="display:inline; color:#85E3FF;">LAP</span>
    <span id="edgedp_algo2" style="display:none; color:#85E3FF;">degSeq_Lap</span><br>
    <input type = "checkbox" onclick = "changevisibility(2)" id = "algorithm3">
    <span id="sgcedgedp_algo3" style="display:inline; color:#b8a9c9;">Smooth</span>
    <span id="nodedp_algo3" style="display:inline; color:#b8a9c9;">nodeTrun_Smooth</span><br>
    <input type = "checkbox" onclick = "changevisibility(3)" id = "algorithm4">
    <span id="nodedp_algo4" style="display:inline; color:#c83349;">edgeAdd_degHisPart_Lap</span><br>
    <input type = "checkbox" onclick = "changevisibility(4)" id = "algorithm5">
    <span id="nodedp_algo5" style="display:inline; color:#622569;">edgeAdd_degCum_Lap</span><br>
    <input type = "checkbox" onclick = "changevisibility(5)" id = "algorithm6">
    <span id="nodedp_algo6" style="display:inline; color:#3fbf5b;">edgeAdd_degCum_Lap_variant</span><br>
  </form><br>
  <br>
  
  </div>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

</body>

</html>
